<tool id="humann2_join_tables" name="Join HUMAnN2 table" version="0.6.1">
    <description></description>

    <macros>
        <import>humann2_macros.xml</import>
    </macros>

    <expand macro="requirements"/>
    <expand macro="stdio"/>

    <version_command>
<![CDATA[
    humann2_join_tables --version
]]>
    </version_command>

    <command><![CDATA[
        `mkdir tmp_dir`
        && 

        #for $file in $files:
            #if $files.select_name_file.select_name_file_test == "True":
                --sample_name "${file.sample_name}"
            #end if

            -i $input_files
            -i $file tmp_dir/$filename            
        #end for

            -o $joined_table           
    ]]></command>

    <inputs>

        <repeat name="files" title="Add an input file" >
            <conditional name="select_name_file">
                <param name='select_name_file_test' type="select" label="Choose a new name for the file?" help="">
                    <option value="True">Yes</option>
                    <option value="False" selected="true">No</option>
                </param>
                <when value="True">
                    <param name="sample_name" type="text" label="Name of the file" help="(--sample_name)"/>
                </when>
            </conditional>
            <param name="input_files" type="data" format="tsv,biom" multiple="true" label="Gene/pathway tables" help=""/>
        </repeat>
    </inputs>

    <outputs>
        <data format="tsv,biom" name="joined_table" label="Joined table for ${on_string} (HUMAnN2)" />
    </outputs>

    <tests>
        <test>
            <param name="files_0|select_name_file" value="False"/>
            <param name="files_0|input_files" value="humann2_fastq_pathabundance.tsv"/>
            <param name="files_1|select_name_file" value="False"/>
            <param name="files_1|input_files" value="humann2_m8_pathabundance.tsv"/>
            <output name="joined_table" file="joined_fastq_m8_pathabundance_output.tsv,biom"/>
        </test>
    </tests>

    <help><![CDATA[
**What it does**

Join HUMAnN2 tables is a tool to join gene, pathway, or taxonomy tables of multiple samples in a single table.

HUMAnN is a pipeline for efficiently and accuretly profiling the presence/absence and abundance of microbial pathways in a community from metagenomic or metatranscriptomic sequencing data. `Read more about the tool <http://huttenhower.sph.harvard.edu/humann2/manual>`_.
    ]]></help>

    <citations>
    </citations>
</tool>